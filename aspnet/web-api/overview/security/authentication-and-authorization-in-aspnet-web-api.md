---
uid: web-api/overview/security/authentication-and-authorization-in-aspnet-web-api
title: Autenticación y autorización en ASP.NET Web API | Microsoft Docs
author: MikeWasson
description: Proporciona una descripción general de la autenticación y autorización en ASP.NET Web API.
ms.author: riande
ms.date: 11/27/2012
ms.assetid: 6dfb51ea-9f4d-4e70-916c-8ef8344a88d6
msc.legacyurl: /web-api/overview/security/authentication-and-authorization-in-aspnet-web-api
msc.type: authoredcontent
ms.openlocfilehash: 368d2b9456d12b2bb4063a23333e5c8837faa3b8
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/06/2020
ms.locfileid: "78484423"
---
# <a name="authentication-and-authorization-in-aspnet-web-api"></a><span data-ttu-id="d7a5b-103">Autenticación y autorización en ASP.NET Web API</span><span class="sxs-lookup"><span data-stu-id="d7a5b-103">Authentication and Authorization in ASP.NET Web API</span></span>

<span data-ttu-id="d7a5b-104">por [Mike Wasson](https://github.com/MikeWasson)</span><span class="sxs-lookup"><span data-stu-id="d7a5b-104">by [Mike Wasson](https://github.com/MikeWasson)</span></span>

<span data-ttu-id="d7a5b-105">Ha creado una API Web, pero ahora desea controlar el acceso a ella.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-105">You've created a web API, but now you want to control access to it.</span></span> <span data-ttu-id="d7a5b-106">En esta serie de artículos, veremos algunas opciones para proteger una API Web de usuarios no autorizados.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-106">In this series of articles, we'll look at some options for securing a web API from unauthorized users.</span></span> <span data-ttu-id="d7a5b-107">Esta serie cubrirá la autenticación y la autorización.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-107">This series will cover both authentication and authorization.</span></span>

- <span data-ttu-id="d7a5b-108">La *autenticación* está conociendo la identidad del usuario.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-108">*Authentication* is knowing the identity of the user.</span></span> <span data-ttu-id="d7a5b-109">Por ejemplo, Alice inicia sesión con su nombre de usuario y contraseña, y el servidor usa la contraseña para autenticar a Alice.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-109">For example, Alice logs in with her username and password, and the server uses the password to authenticate Alice.</span></span>
- <span data-ttu-id="d7a5b-110">La *autorización* es decidir si un usuario puede realizar una acción.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-110">*Authorization* is deciding whether a user is allowed to perform an action.</span></span> <span data-ttu-id="d7a5b-111">Por ejemplo, Alicia tiene permiso para obtener un recurso, pero no para crear un recurso.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-111">For example, Alice has permission to get a resource but not create a resource.</span></span>

<span data-ttu-id="d7a5b-112">En el primer artículo de la serie se ofrece una introducción general a la autenticación y autorización en ASP.NET Web API.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-112">The first article in the series gives a general overview of authentication and authorization in ASP.NET Web API.</span></span> <span data-ttu-id="d7a5b-113">En otros temas se describen los escenarios comunes de autenticación de Web API.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-113">Other topics describe common authentication scenarios for Web API.</span></span>

> [!NOTE]
> <span data-ttu-id="d7a5b-114">Gracias a las personas que revisaron esta serie y nos proporcionaban comentarios valiosos: Rick Anderson, Broderick, Barry Dorrans, Tom Dykstra, Hongmei GE, David Paspartúson, Daniel Roth, Tim Teebken.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-114">Thanks to the people who reviewed this series and provided valuable feedback: Rick Anderson, Levi Broderick, Barry Dorrans, Tom Dykstra, Hongmei Ge, David Matson, Daniel Roth, Tim Teebken.</span></span>

## <a name="authentication"></a><span data-ttu-id="d7a5b-115">Autenticación</span><span class="sxs-lookup"><span data-stu-id="d7a5b-115">Authentication</span></span>

<span data-ttu-id="d7a5b-116">Web API supone que la autenticación se produce en el host.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-116">Web API assumes that authentication happens in the host.</span></span> <span data-ttu-id="d7a5b-117">Para el hospedaje Web, el host es IIS, que usa los módulos HTTP para la autenticación.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-117">For web-hosting, the host is IIS, which uses HTTP modules for authentication.</span></span> <span data-ttu-id="d7a5b-118">Puede configurar el proyecto para que use cualquiera de los módulos de autenticación integrados en IIS o ASP.NET, o escribir su propio módulo HTTP para realizar la autenticación personalizada.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-118">You can configure your project to use any of the authentication modules built in to IIS or ASP.NET, or write your own HTTP module to perform custom authentication.</span></span>

<span data-ttu-id="d7a5b-119">Cuando el host autentica al usuario, crea una *entidad*de seguridad, que es un objeto [IPrincipal](https://msdn.microsoft.com/library/System.Security.Principal.IPrincipal.aspx) que representa el contexto de seguridad en el que se ejecuta el código.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-119">When the host authenticates the user, it creates a *principal*, which is an [IPrincipal](https://msdn.microsoft.com/library/System.Security.Principal.IPrincipal.aspx) object that represents the security context under which code is running.</span></span> <span data-ttu-id="d7a5b-120">El host asocia la entidad de seguridad al subproceso actual estableciendo **Thread. CurrentPrincipal**.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-120">The host attaches the principal to the current thread by setting **Thread.CurrentPrincipal**.</span></span> <span data-ttu-id="d7a5b-121">La entidad de seguridad contiene un objeto de **identidad** asociado que contiene información sobre el usuario.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-121">The principal contains an associated **Identity** object that contains information about the user.</span></span> <span data-ttu-id="d7a5b-122">Si el usuario está autenticado, la propiedad **Identity. IsAuthenticated** devuelve **true**.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-122">If the user is authenticated, the **Identity.IsAuthenticated** property returns **true**.</span></span> <span data-ttu-id="d7a5b-123">En el caso de las solicitudes anónimas, **IsAuthenticated** devuelve **false**.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-123">For anonymous requests, **IsAuthenticated** returns **false**.</span></span> <span data-ttu-id="d7a5b-124">Para obtener más información acerca de las entidades de seguridad, consulte [seguridad basada en roles](https://msdn.microsoft.com/library/shz8h065.aspx).</span><span class="sxs-lookup"><span data-stu-id="d7a5b-124">For more information about principals, see [Role-Based Security](https://msdn.microsoft.com/library/shz8h065.aspx).</span></span>

### <a name="http-message-handlers-for-authentication"></a><span data-ttu-id="d7a5b-125">Controladores de mensajes HTTP para la autenticación</span><span class="sxs-lookup"><span data-stu-id="d7a5b-125">HTTP Message Handlers for Authentication</span></span>

<span data-ttu-id="d7a5b-126">En lugar de usar el host para la autenticación, puede poner lógica de autenticación en un [controlador de mensajes http](../advanced/http-message-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="d7a5b-126">Instead of using the host for authentication, you can put authentication logic into an [HTTP message handler](../advanced/http-message-handlers.md).</span></span> <span data-ttu-id="d7a5b-127">En ese caso, el controlador de mensajes examina la solicitud HTTP y establece la entidad de seguridad.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-127">In that case, the message handler examines the HTTP request and sets the principal.</span></span>

<span data-ttu-id="d7a5b-128">¿Cuándo se deben usar los controladores de mensajes para la autenticación?</span><span class="sxs-lookup"><span data-stu-id="d7a5b-128">When should you use message handlers for authentication?</span></span> <span data-ttu-id="d7a5b-129">Estos son algunos de los inconvenientes:</span><span class="sxs-lookup"><span data-stu-id="d7a5b-129">Here are some tradeoffs:</span></span>

- <span data-ttu-id="d7a5b-130">Un módulo HTTP ve todas las solicitudes que pasan a través de la canalización ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-130">An HTTP module sees all requests that go through the ASP.NET pipeline.</span></span> <span data-ttu-id="d7a5b-131">Un controlador de mensajes solo ve las solicitudes que se enrutan a la API Web.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-131">A message handler only sees requests that are routed to Web API.</span></span>
- <span data-ttu-id="d7a5b-132">Puede establecer controladores de mensajes por ruta, que permite aplicar un esquema de autenticación a una ruta específica.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-132">You can set per-route message handlers, which lets you apply an authentication scheme to a specific route.</span></span>
- <span data-ttu-id="d7a5b-133">Los módulos HTTP son específicos de IIS.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-133">HTTP modules are specific to IIS.</span></span> <span data-ttu-id="d7a5b-134">Los controladores de mensajes son independientes del host, por lo que se pueden usar tanto con el hospedaje web como con el autohospedaje.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-134">Message handlers are host-agnostic, so they can be used with both web-hosting and self-hosting.</span></span>
- <span data-ttu-id="d7a5b-135">Los módulos HTTP participan en el registro de IIS, la auditoría, etc.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-135">HTTP modules participate in IIS logging, auditing, and so on.</span></span>
- <span data-ttu-id="d7a5b-136">Los módulos HTTP se ejecutan antes en la canalización.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-136">HTTP modules run earlier in the pipeline.</span></span> <span data-ttu-id="d7a5b-137">Si controla la autenticación en un controlador de mensajes, la entidad de seguridad no se establece hasta que se ejecuta el controlador.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-137">If you handle authentication in a message handler, the principal does not get set until the handler runs.</span></span> <span data-ttu-id="d7a5b-138">Además, la entidad de seguridad vuelve a la entidad de seguridad anterior cuando la respuesta deja el controlador de mensajes.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-138">Moreover, the principal reverts back to the previous principal when the response leaves the message handler.</span></span>

<span data-ttu-id="d7a5b-139">Por lo general, si no necesita admitir el autohospedaje, un módulo HTTP es una opción mejor.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-139">Generally, if you don't need to support self-hosting, an HTTP module is a better option.</span></span> <span data-ttu-id="d7a5b-140">Si necesita admitir el autohospedaje, considere la posibilidad de usar un controlador de mensajes.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-140">If you need to support self-hosting, consider a message handler.</span></span>

### <a name="setting-the-principal"></a><span data-ttu-id="d7a5b-141">Establecimiento de la entidad de seguridad</span><span class="sxs-lookup"><span data-stu-id="d7a5b-141">Setting the Principal</span></span>

<span data-ttu-id="d7a5b-142">Si la aplicación realiza una lógica de autenticación personalizada, debe establecer la entidad de seguridad en dos lugares:</span><span class="sxs-lookup"><span data-stu-id="d7a5b-142">If your application performs any custom authentication logic, you must set the principal on two places:</span></span>

- <span data-ttu-id="d7a5b-143">**Thread. CurrentPrincipal**.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-143">**Thread.CurrentPrincipal**.</span></span> <span data-ttu-id="d7a5b-144">Esta propiedad es la manera estándar de establecer la entidad de seguridad del subproceso en .NET.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-144">This property is the standard way to set the thread's principal in .NET.</span></span>
- <span data-ttu-id="d7a5b-145">**HttpContext. Current. User**.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-145">**HttpContext.Current.User**.</span></span> <span data-ttu-id="d7a5b-146">Esta propiedad es específica de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-146">This property is specific to ASP.NET.</span></span>

<span data-ttu-id="d7a5b-147">En el código siguiente se muestra cómo establecer la entidad de seguridad:</span><span class="sxs-lookup"><span data-stu-id="d7a5b-147">The following code shows how to set the principal:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample1.cs)]

<span data-ttu-id="d7a5b-148">Para el hospedaje Web, debe establecer la entidad de seguridad en ambos lugares; en caso contrario, el contexto de seguridad puede ser incoherente.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-148">For web-hosting, you must set the principal in both places; otherwise the security context may become inconsistent.</span></span> <span data-ttu-id="d7a5b-149">No obstante, para el autohospedaje, **HttpContext. Current** es NULL.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-149">For self-hosting, however, **HttpContext.Current** is null.</span></span> <span data-ttu-id="d7a5b-150">Para asegurarse de que el código sea independiente del host, por lo tanto, compruebe si hay valores NULL antes de asignarlos a **HttpContext. Current**, como se muestra.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-150">To ensure your code is host-agnostic, therefore, check for null before assigning to **HttpContext.Current**, as shown.</span></span>

## <a name="authorization"></a><span data-ttu-id="d7a5b-151">Autorización</span><span class="sxs-lookup"><span data-stu-id="d7a5b-151">Authorization</span></span>

<span data-ttu-id="d7a5b-152">La autorización se produce más adelante en la canalización, más cerca del controlador.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-152">Authorization happens later in the pipeline, closer to the controller.</span></span> <span data-ttu-id="d7a5b-153">Esto le permite tomar decisiones más pormenorizadas al conceder acceso a los recursos.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-153">That lets you make more granular choices when you grant access to resources.</span></span>

- <span data-ttu-id="d7a5b-154">Los *filtros de autorización* se ejecutan antes de la acción de controlador.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-154">*Authorization filters* run before the controller action.</span></span> <span data-ttu-id="d7a5b-155">Si la solicitud no está autorizada, el filtro devuelve una respuesta de error y no se invoca la acción.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-155">If the request is not authorized, the filter returns an error response, and the action is not invoked.</span></span>
- <span data-ttu-id="d7a5b-156">Dentro de una acción del controlador, puede obtener la entidad de seguridad actual de la propiedad **ApiController. User** .</span><span class="sxs-lookup"><span data-stu-id="d7a5b-156">Within a controller action, you can get the current principal from the **ApiController.User** property.</span></span> <span data-ttu-id="d7a5b-157">Por ejemplo, puede filtrar una lista de recursos basándose en el nombre de usuario y devolver solo los recursos que pertenecen a ese usuario.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-157">For example, you might filter a list of resources based on the user name, returning only those resources that belong to that user.</span></span>

![](authentication-and-authorization-in-aspnet-web-api/_static/image1.png)

<a id="auth3"></a>
### <a name="using-the-authorize-attribute"></a><span data-ttu-id="d7a5b-158">Usar el atributo [Authorize]</span><span class="sxs-lookup"><span data-stu-id="d7a5b-158">Using the [Authorize] Attribute</span></span>

<span data-ttu-id="d7a5b-159">Web API proporciona un filtro de autorización integrado, [AuthorizeAttribute](https://msdn.microsoft.com/library/system.web.http.authorizeattribute.aspx).</span><span class="sxs-lookup"><span data-stu-id="d7a5b-159">Web API provides a built-in authorization filter, [AuthorizeAttribute](https://msdn.microsoft.com/library/system.web.http.authorizeattribute.aspx).</span></span> <span data-ttu-id="d7a5b-160">Este filtro comprueba si el usuario está autenticado.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-160">This filter checks whether the user is authenticated.</span></span> <span data-ttu-id="d7a5b-161">De lo contrario, devuelve el código de Estado HTTP 401 (no autorizado), sin invocar la acción.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-161">If not, it returns HTTP status code 401 (Unauthorized), without invoking the action.</span></span>

<span data-ttu-id="d7a5b-162">Puede aplicar el filtro globalmente, en el nivel de controlador o en el nivel de acciones individuales.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-162">You can apply the filter globally, at the controller level, or at the level of individual actions.</span></span>

<span data-ttu-id="d7a5b-163">**Globalmente**: para restringir el acceso para cada controlador de API Web, agregue el filtro **AuthorizeAttribute** a la lista de filtros globales:</span><span class="sxs-lookup"><span data-stu-id="d7a5b-163">**Globally**: To restrict access for every Web API controller, add the **AuthorizeAttribute** filter to the global filter list:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample2.cs)]

<span data-ttu-id="d7a5b-164">**Controlador**: para restringir el acceso a un controlador específico, agregue el filtro como atributo al controlador:</span><span class="sxs-lookup"><span data-stu-id="d7a5b-164">**Controller**: To restrict access for a specific controller, add the filter as an attribute to the controller:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample3.cs)]

<span data-ttu-id="d7a5b-165">**Acción**: para restringir el acceso a acciones específicas, agregue el atributo al método de acción:</span><span class="sxs-lookup"><span data-stu-id="d7a5b-165">**Action**: To restrict access for specific actions, add the attribute to the action method:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample4.cs)]

<span data-ttu-id="d7a5b-166">Como alternativa, puede restringir el controlador y, a continuación, permitir el acceso anónimo a acciones específicas mediante el `[AllowAnonymous]` atributo.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-166">Alternatively, you can restrict the controller and then allow anonymous access to specific actions, by using the `[AllowAnonymous]` attribute.</span></span> <span data-ttu-id="d7a5b-167">En el ejemplo siguiente, el método `Post` está restringido, pero el método `Get` permite el acceso anónimo.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-167">In the following example, the `Post` method is restricted, but the `Get` method allows anonymous access.</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample5.cs)]

<span data-ttu-id="d7a5b-168">En los ejemplos anteriores, el filtro permite que cualquier usuario autenticado tenga acceso a los métodos restringidos; solo se conservan los usuarios anónimos. También puede limitar el acceso a usuarios específicos o a usuarios en roles específicos:</span><span class="sxs-lookup"><span data-stu-id="d7a5b-168">In the previous examples, the filter allows any authenticated user to access the restricted methods; only anonymous users are kept out. You can also limit access to specific users or to users in specific roles:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample6.cs)]

> [!NOTE]
> <span data-ttu-id="d7a5b-169">El filtro **AuthorizeAttribute** para los controladores de API Web se encuentra en el espacio de nombres **System. Web. http** .</span><span class="sxs-lookup"><span data-stu-id="d7a5b-169">The **AuthorizeAttribute** filter for Web API controllers is located in the **System.Web.Http** namespace.</span></span> <span data-ttu-id="d7a5b-170">Hay un filtro similar para los controladores MVC en el espacio de nombres **System. Web. Mvc** , que no es compatible con los controladores de API Web.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-170">There is a similar filter for MVC controllers in the **System.Web.Mvc** namespace, which is not compatible with Web API controllers.</span></span>

### <a name="custom-authorization-filters"></a><span data-ttu-id="d7a5b-171">Filtros de autorización personalizados</span><span class="sxs-lookup"><span data-stu-id="d7a5b-171">Custom Authorization Filters</span></span>

<span data-ttu-id="d7a5b-172">Para escribir un filtro de autorización personalizado, derive de uno de estos tipos:</span><span class="sxs-lookup"><span data-stu-id="d7a5b-172">To write a custom authorization filter, derive from one of these types:</span></span>

- <span data-ttu-id="d7a5b-173">**AuthorizeAttribute**.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-173">**AuthorizeAttribute**.</span></span> <span data-ttu-id="d7a5b-174">Extienda esta clase para realizar la lógica de autorización basada en el usuario actual y en los roles del usuario.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-174">Extend this class to perform authorization logic based on the current user and the user's roles.</span></span>
- <span data-ttu-id="d7a5b-175">**AuthorizationFilterAttribute**.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-175">**AuthorizationFilterAttribute**.</span></span> <span data-ttu-id="d7a5b-176">Extienda esta clase para realizar la lógica de autorización sincrónica que no se basa necesariamente en el usuario o el rol actual.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-176">Extend this class to perform synchronous authorization logic that is not necessarily based on the current user or role.</span></span>
- <span data-ttu-id="d7a5b-177">**IAuthorizationFilter**.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-177">**IAuthorizationFilter**.</span></span> <span data-ttu-id="d7a5b-178">Implemente esta interfaz para realizar la lógica de autorización asincrónica; por ejemplo, si la lógica de autorización realiza llamadas asincrónicas de e/s o de red.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-178">Implement this interface to perform asynchronous authorization logic; for example, if your authorization logic makes asynchronous I/O or network calls.</span></span> <span data-ttu-id="d7a5b-179">(Si la lógica de autorización está enlazada a la CPU, es más fácil derivar de **AuthorizationFilterAttribute**, porque después no es necesario escribir un método asincrónico).</span><span class="sxs-lookup"><span data-stu-id="d7a5b-179">(If your authorization logic is CPU-bound, it is simpler to derive from **AuthorizationFilterAttribute**, because then you don't need to write an asynchronous method.)</span></span>

<span data-ttu-id="d7a5b-180">En el diagrama siguiente se muestra la jerarquía de clases de la clase **AuthorizeAttribute** .</span><span class="sxs-lookup"><span data-stu-id="d7a5b-180">The following diagram shows the class hierarchy for the **AuthorizeAttribute** class.</span></span>

![](authentication-and-authorization-in-aspnet-web-api/_static/image2.png)

### <a name="authorization-inside-a-controller-action"></a><span data-ttu-id="d7a5b-181">Autorización dentro de una acción de controlador</span><span class="sxs-lookup"><span data-stu-id="d7a5b-181">Authorization Inside a Controller Action</span></span>

<span data-ttu-id="d7a5b-182">En algunos casos, puede permitir que una solicitud continúe, pero cambiar el comportamiento en función de la entidad de seguridad.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-182">In some cases, you might allow a request to proceed, but change the behavior based on the principal.</span></span> <span data-ttu-id="d7a5b-183">Por ejemplo, la información que devuelva podría cambiar en función del rol del usuario.</span><span class="sxs-lookup"><span data-stu-id="d7a5b-183">For example, the information that you return might change depending on the user's role.</span></span> <span data-ttu-id="d7a5b-184">Dentro de un método de controlador, puede obtener la entidad de seguridad actual de la propiedad **ApiController. User** .</span><span class="sxs-lookup"><span data-stu-id="d7a5b-184">Within a controller method, you can get the current principal from the **ApiController.User** property.</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample7.cs)]
